\documentclass[twocolumn]{article}
%\documentclass{article}
\usepackage{etex}\reserveinserts{28}
\usepackage{listings}
\usepackage{ifxetex}
\ifxetex
 \usepackage{fontspec}
 \defaultfontfeatures{Ligatures=TeX}
 \setmainfont{Times New Roman}
\else
 \usepackage{times}
 \usepackage[utf8]{inputenc}
\fi

\usepackage{listings}
\lstset{basicstyle={\color{blue!60!black!90}\tt},%
        columns=fixed,%
        showspaces=false,%
        showstringspaces=false%
        basewidth={0.45em},
        fontadjust=true,
}

\newfontfamily\doulos[Mapping=tex-text]{Doulos SIL}
\DeclareTextFontCommand{\textIPA}{\doulos}

\usepackage{graphicx}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage{colortbl}
%\usepackage{setspace}
\usepackage[citestyle=authoryear,dashed=false,bibstyle=authoryear,maxcitenames=2,maxbibnames=6,minnames=1,backend=biber]{biblatex}
\addbibresource{trmorph-manual.bib}


\usepackage{lingmacros}
\usepackage{amsmath}
\usepackage{trmorph-manual}

%\usepackage{polyglossia}
%\setlength{\parskip}{1.2ex}
%\setlength{\parindent}{0em}





\title{TRmorph: A morphological analyzer for Turkish}
\author{Çağrı Çöltekin}
\date{\today{} (\textbf{draft!})}

\begin{document}
\twocolumn[
\begin{@twocolumnfalse}
\maketitle
% \textcolor{red}{%
% This document describes the new/development version
% of TRmorph. As such, there may be some mismatches between what is
% documented here and how the analyzer behaves. This version is a
% complete overwrite of the previous version reported in
% \textcite{coltekin2010}. If you are using the older version (you
% shouldn't), this document is probably useless for you.
% }
% \vspace{1cm}
\end{@twocolumnfalse}
]

\pdfbookmark[0]{TRmorph}{TRmorph}

\section{Introduction}

TRmorph is an open-source\footnote{Current version of TRmorph is
licensed under \href{http://www.gnu.org/licenses/lgpl.html}{GNU Lesser
General Public License}. See README file in the TRmorph distribution
for more information.} finite-state morphological analyzer for
Turkish.  This document describes how to use the tools that comes with
this package, as well as some implementation details that may be
helpful for people who want to customize this open-source tool for
their own needs.
The source code is available at \url{https://github.com/coltekin/TRmorph},
and of  the analyzer and a web-based demo can be accessed at \url{http://coltekin.net/cagri/trmorph}. 

This document describes the current version of the analyzer and additional tools described in \textcite{coltekin2014lrec}.
This version is a complete rewrite of the earlier version report in \textcite{coltekin2010}.  
The earlier version of TRmorph was implemented using SFST \parencite{schmid2005}, 
the current version is implemented with more popular finite state description languages \emph{lexc} and \emph{xfst} from Xerox \parencite{beesley2003}, 
using Foma \parencite{hulden2009} as the main development tool. 

The lexc/xfst implementation of TRmorph should compile with any
lexc/xfst compiler without much additional effort.  The only
foma-specific notation used in the morphology description is about
handling simple reduplication, which can also be handled with twolc
rules, or compile-replace \parencite{beesley2003}.\footnote{TRmorph
can be compiled with HFST \parencite{linden2009} without modification
since HFST uses foma as the back end for parsing xfst files.}

\section{How to use it}

\subsection{Compilation from the source}

To compile TRmorph from the source, you need a lexc/xfst compiler such
as foma, a C preprocessor, GNU make and some standard UNIX utilities.

If all requirements are in place, to build analyzer/generator FST, 
you should type \lstinline{make} in the main TRmorph distribution directory. 
The resulting binary automaton file will be \lstinline{trmorph.fst}.

Trmorph comes with a set of other finite-state tools that are useful
in various NLP tasks. Currently, tolls for the following tasks are
distributed together with TRmorph.
\begin{itemize}\addtolength{\itemsep}{-0.5\baselineskip}
\item stemming/lemmatization
\item morphological segmentation
\item hyphenation
\item guessing unknown words
\end{itemize}

To compile these tools, you should specify the FST you want to
build as an argument to \lstinline{make}, e.g., 
\lstinline{make stemmer} 
will build an binary automaton called \lstinline{stem.fst}.
These additional tools are described in Section~\ref{sec:other-tools}.

\subsection{Customizing TRmorph}

TRmorph is an open source utility. As a result, you are free to modify
the source according to your needs. Source code includes some useful
comments on what/how/where things are done. Furthermore, TRmorph can
be customized for some common choices during the compilation. These
options are typically related to more relaxed analysis. For example
whether to allow non-capitalized proper names, or analyze (and
generate) text written in all capitals, or set the decimal and
thousand separator in numbers. These options are set in the file
\lstinline{options.h}. The file contains documentation along with the
existing options. This feature is under development (as of July 2013),
new options are currently being added, and existing options may not
fully work as intended yet.

Another common need for customizing a morphological analyzer is to add
or modify the lexical entries. The lexicon structure and format of the
lexical entries are described in Section~\ref{sec:lexicon}.

\subsection{\label{sec:try}Trying it out}

Assuming you have built the binary \lstinline{trmorph.fst} using foma,
you can simply start foma and use xfst commands implemented in foma to
analyze and generate the words. Here is an example session:

\begin{lstlisting}[basicstyle={\color{blue!60!black!90}\small\tt}]
$ foma
foma[0]: regex @"trmorph.fst";
2.1 MB. 62236 states, 135237 arcs, Cyclic.
foma[1]: up okudum
oku<V><past><1s>
foma[1]: down oku<V><past><2s>
okudun
\end{lstlisting}%stopzone 

The first line is  typed at the shell prompt to start foma.  The
second line reads the FST specified in \lstinline{trmorph.fst} into
the foma environment. The fourth line asks for the analysis of the verb
\xmplt{okudum}{I read-PAST}, and the fifth line is the output of the
analysis. The sixth line asks for the generation of the analysis string
produced earlier, modifying the agreement marker to  second person
singular agreement.

Note that part of the output is removed for readability. We should
also note that this example presents one of the rare cases where the
analysis is unambiguous. Turkish morphological analysis is an
ambiguous process, and TRmorph does not try to avoid it during the
analysis. 
Section~\ref{sec:ambiguity}) lists some of the potential sources of ambiguity. 
For most purposes, the output of the morphological analyzer needs to be disambiguated. 
A simple morphological disambiguator is included in TRmorph distribution (see Section~\ref{sec:disambiguation}).


Once you are convinced that the output may be useful for your purposes, 
you will probably want to use it for analyzing large amount of text. 
For batch analysis tasks \lstinline{flookup} utility distributed with foma is a better fit. 

To use the analyzer with the HFST, you need to compile the source
automaton with HFST tools. 

\section{The tagset}


The description of the morphology in TRmorph mostly follows
\textcite{goksel2005}. However, there are some divergences, and tags used
in TRmorph analyses does not necessarily match with any of the tags
used in any grammar book. This section describes the tags used in the
current version of TRmorph.  The aim of this section is to help users
understand the output of the system. Occasional discussion of the
morphological process is included, but this section documents neither
the morphology of the language nor the way it is implemented in
TRmorph.  Our focus in this section is to describe the tags one finds
in the analysis strings produced by the analyzer (or tags one
needs to use for generation).  The index at the end of the document
also allows easy access to the points where a particular tag is
defined or mentioned in this document.

A clarification of the notation for the surface forms is in order
before starting the documentation of the tagset and related suffixes.
Suffixes in Turkish often contain under-specified vowels and
consonants that are resolved according to morphophonological rules,
like vowel harmony. These vowels and consonants are indicated with
capital letters listed below.

\begin{description}
\item[A] is realized as either `a' or  `e'.
\item[I] is realized as either `ı', `i', `u' or  `ü'.
\item[D] is realized as either `d' or  `t'.
\item[P] is realized as either `p' or  `b'.
\item[K] is realized as either `k', `ğ' or  `y'.
\item[C] is realized as either `c' or  `ç'.
\end{description}

A letter in parentheses indicate a buffer consonant or vowel, that may
be dropped in certain contexts.

\subsection{General structure of the analysis strings}

Before describing individual morphological tags used in analysis strings, 
this section briefly describes the general structure of the analysis strings
produced (or accepted in the generation model) by TRmorph.
In this document we use the term \emph{morphological tag} for symbols such as \mtag{V}, or \mtag{past}.
The term \emph{morphological analysis} (or \emph{analysis}) is used for a root word followed by a sequence of morphological tags. 
In the example presented in Section~\ref{sec:try}, 
the analysis \mroot{oku}\mtag{V}\mtag{past}\mtag{1s} (for the word \xmplt{okudum}{I read-PAST}) consists of the root word \xmplt{oku}{read} 
and morphological tags \mtag{V}, \mtag{past} and \mtag{1s} 
that correspond to part-of-speech category of the root (verb), past tense marker
and first person singular subject--predicate agreement marker.
The inflections that are default for a word category, 
such as the fact that the verb above positive (or is not negated), 
are not indicated in the analyses.

An interesting aspect of Turkish morphology is that 
the words cannot just be analyzed as belonging to a syntactic category and having a set of inflections based on a category.
Due to productive derivational process, 
an inflected word may change its part of speech and may also get further inflections.
Example~(\ref{ig-example}) demonstrates this process with the analysis of of the word \xmpl{evdekilerinki}{the \emph{ones} that belong to the \emph{ones} in the house}, as in `the \emph{book} that belong to the \emph{people} in the house'.

\enumsentence{\label{ig-example}%
\mroot{ev}\mtag{N}\mtag{loc}\mtag{ki}\mtag{Adj}\mtag{0}\mtag{N}\mtag{pl}\mtag{gen}\mtag{ki}\mtag{Adj}}

The example analysis in (\ref{ig-example}) can be broken down into the following parts.

\begin{enumerate}
\item The initial noun \xmpl{ev} with the locative maker.
\item Addition of the suffix \sffx{ki} derives an adjective.
\item The adjective becomes a (pro)nominal with a zero derivation,
which is inflected for plural and genitive case.
\item Yet another \sffx{ki} is suffixed, and the word becomes an
adjective again.\footnote{More likely reading of this example
includes another zero derivation causing final POS to be again noun.}
\end{enumerate}

The example in (\ref{ig-example}) is also interesting because of the fact the suffix \sffx{ki} may result indefinitely long words (see Section~\ref{ssec:ki}).


In Turkish NLP literature, this process is reflected by so-called \emph{inflectional groups} (IGs) that,
for example, can participate in dependency relations.
Each step in the above description describes a different inflectional group.
The analysis strings produced (or accepted in the generation model) by TRmorph follow the idea of inflectional groups with a slight difference than the examples in the literature.
TRmorph makes a distinction between the derivational marker that leads to the POS tag of a IG from the inflectional features of the IG,  
and the derivational marker is always precedes the POS tag.
For example, the second inflectional group in (\ref{ig-example}) is \mtag{ki}\mtag{Adj},
indicating the adjective derived by \mtag{ki} has not (non-default) inflections.

By default, TRmorph does not mark IG boundaries explicitly. 
However, one can easily trace the IG changes following the POS tags. 
All POS tag names start with a capital letter, 
while other tags always start with a lowercase letter or number. 
The tag immediately before a new POS tag is always the derivational marker that lead to the new POS tag.
If the derivation does not have a corresponding surface affix, 
a zero-derivation tag \mtag[def]{0} is inserted before the POS tag.

\subsection{Part-of-speech tags}



%\begin{table}[t]
%\caption{\label{tbl:pos-tags}The list of part of speech tags in
%TRmorph along with the corresponding tags in some of the output
%produced by in \citeauthor{oflazer1994}'s (\citeyear{oflazer1994})
%morphological analyzer.}
%\begin{center}
%\begin{tabular}{lll}\toprule
%Tag          & Description       & Oflazer's tag \\
%\toprule
%\mtagD{Alpha} & Symbols of alphabet & ?\\
%\mtagD{Adj}   & Adjective         & +Adj\\
%\mtagD{Adv}   & Adverb            & +Adverb\\
%\mtagD{Cnj}   & Conjunction       & +Conjunction\\
%\mtagD{Det}   & Determiner        & +Det\\
%\mtagD{Exist} & \xmpl{var} and \xmpl{yok}    & +Adj\\
%\mtagD{Ij}    & Interjection      & +Interj \\
%\mtagD{N}     & Noun              & +Noun\\
%\mtagD{Not}   & \xmpl{değil}      & +Verb\\
%\mtagD{Num}   & Number            & +Num\\
%\mtagD{Onom}  & Onomatopoeia      & ?\\
%\mtagD{Postp} & Postposition      & +Postp\\
%\mtagD{Prn}   & Pronoun           & +Pron\\
%\mtagD{Punc}  & Punctuation       & +Punc\\
%\mtagD{Q}     & Question particle & +Ques, also +QuesP\\
%\mtagD{V}     & Verb              & +Verb\\
%\bottomrule
%\end{tabular}
%\end{center}
%\end{table}

\begin{table}[t]
\caption{\label{tbl:pos-tags}The list of part of speech tags in
TRmorph.}
\begin{center}
\begin{tabular}{ll}\toprule
Tag          & Description        \\
\toprule
\mtagD{Alpha} & Symbols of the alphabet \\
\mtagD{Adj}   & Adjective         \\
\mtagD{Adv}   & Adverb            \\
\mtagD{Cnj}   & Conjunction       \\
\mtagD{Det}   & Determiner        \\
\mtagD{Exist} & The words \xmpl{var} and \xmpl{yok}    \\
\mtagD{Ij}    & Interjection      \\
\mtagD{N}     & Noun              \\
\mtagD{Not}   & The word \xmpl{değil}      \\
\mtagD{Num}   & Number            \\
\mtagD{Onom}  & Onomatopoeia      \\
\mtagD{Postp} & Postposition      \\
\mtagD{Prn}   & Pronoun           \\
\mtagD{Punc}  & Punctuation       \\
\mtagD{Q}     & Question particle \xmpl{mI}\\
\mtagD{V}     & Verb              \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

All part-of speech tags used in TRmorph are listed in
Table~\ref{tbl:pos-tags}.  Most POS tags are self explanatory, and
does not require much explanation. The following part of speech tags
are somewhat unusual and deserves some explanation.

\begin{description}
\item[\mtag{Exist}] is used for two words
\xmplt{var}{existent/present} and  \xmplt{yok}{non-existent/absent},
where the latter is marked as \mtag{Exist:neg}, indicating that it is the
negative form (see Section~\ref{ssec:subcat}, for the details of this notation).
These words behave mostly like nouns in their predicate function (with
zero copula), but marking them simply as nouns does blur their
function.  
\item[\mtag{Not}] is used for \xmplt{değil}{not} only. Like \xmpl{var}
and \xmpl{yok}, \xmpl{değil} also behaves like nominal predicates. But
again, marking it as noun or verb hides the fact that it has a special
function.

%%% Other functions of degil??

\item[\mtag{Q}] is used for the question particle \sffx{mI}. The
question particle is written separately from the predicate it
modifies. However, the preferred analysis of question particle in
TRmorph is together with the predicate. This ensures that it follows
the correct form of the predicate it is attached to, and vowel harmony
is applied correctly. However, since we do not assume that the input
is tokenized with this assumption, this form make sure that the input
is analyzed with the cost of precision. The question particle is
discussed further in Section~\ref{ssec:question}.

\end{description}

\subsection{\label{ssec:subcat}Subcategorization of lexemes}

Besides the major major POS tags or word classes discussed above,
TRmorph makes use of a set of subcategory tags to mark features that
are part of a lexeme. Typically the
subcategorization is applied to a root form in the lexicon, but some
morphemes and POS tags after a derivation may also receive a
subcategory tags. Subcategories defined here are features of a morpheme
that do not have a surface realization. Representing these features using a
different notation allows one to make this distinction, and the
surface--analysis mapping becomes (almost) one-to-one.  If a 
representation where all tags have a uniform notation is desired, 
the analyzer source can be modified accordingly, or easier, a simple
regular expression based converter can be used.

The subcategories generally mark semantic differences, but they may
also result in morphosyntactic differences. Lexical subcategorization
in TRmorph output is marked using the syntax
\formattag{Cat:subcat$_1$:subcat$_2$:\ldots}, where `Cat' is a major
category and `subcat$_1$', `subcat$_2$' and so on are sub categories.
The order of subcategory tags are not important (although they are
produced in a consistent order).  A typical example of a subcategory is
\emph{proper} nouns, which are tagged as \mtag{N:prop}. 

The following lists subcategories used in TRmorph for all word classes
that may be specified together with a subcategory.

\begin{description}

\item[Nouns] Besides the tag \mtag[def]{N:prop} marking proper names,
abbreviated nouns are marked with the tag \mtag[def]{N:abbr}. For an
abbreviated proper name, the tag is \mtag[def]{N:prop:abbr}. 

\item[Conjunctions] are subcategorized as
\emph{coordinating}, \emph{adverbial} or \emph{subordinating} 
conjunctions, marked using tags \mtag[def]{Cnj:coo}, \mtag[def]{Cnj:adv},
\mtag[def]{Cnj:sub} respectively. 

The last one of these categories, \mtag{Cnj:sub}, include only a
limited set of conjunctions which come first in a subordinate clause.
These words currently are \xmpl{ki}, \xmpl{eğer} and \xmpl{şayet} (all
borrowings from Persian). The other subordinating particles/words occur
at the end of subordinate clauses, and they are marked as
postpositions (\mtag{Postp}) described below.  Furthermore, most
of the subordination in Turkish is done through suffixation which
is described in Section~\ref{ssec:subordination}.

\item[Pronouns] Pronouns are further categorized as \emph{personal},
\emph{demonstrative} and \emph{locative} pronouns, marked using
\mtag[def]{Prn:pers}, \mtag[def]{Prn:dem}, \mtag[def]{Prn:locp} 
respectively. Furthermore, the pronouns that form
questions, like \xmplt{kim}{who}, and \xmplt{ne}{what}, are
marked as \mtag[def]{Prn:qst}. Subcategory
markers for both aspects can be present. For example \xmplt{kim}{who} would be marked
as \mtag{Prn:pers:qst}.

Besides the above subcategories, personal pronouns get person-number 
agreement markers. These markers can be useful in subject-predicate
agreement as well as in other constructions (such as
genitive-possessive construction involving pronouns). However, the
agreement in Turkish is far from trivially determined (see
\textcite[pp.116--122]{goksel2005}). The markers 
\mtag[def]{Prn:pers:1s},
\mtag[def]{Prn:pers:2s},
\mtag[def]{Prn:pers:3s},
\mtag[def]{Prn:pers:1p},
\mtag[def]{Prn:pers:2p} and
\mtag[def]{Prn:pers:3p} are tags used for the personal pronouns with 
person-number agreement. The agreement markers are further
discussed in Section~\ref{ssec:pagr}. 

The reflexive pronoun \xmpl{kendi} and its different person forms are
marked as \mtag[def]{Prn:refl}. Like other personal pronouns,
reflexive pronouns are also marked with a person agreement marker.

Subcategorization of pronouns, particularly as personal pronouns, are
sometimes not a clear decision. Subcategories of some pronouns are
left unspecified even though they are often used as personal
pronouns, and some pronoun marked as personal pronouns may refer to
entities other than people.

\item[Determiners] are marked for definiteness. 
\emph{Definite} determiners are marked \mtag[def]{Det:def} and
\emph{indefinite} determiners are marked \mtag[def]{Det:indef}. The question
words that fill the same syntactic slot as determiners \xmplt{ne kadar}{how much} and
\xmplt{hangi}{which} are tagged with \mtag{Det:qst}. 

Further subcategorization of determiners (for example 
quantifiers) can be implemented in the future.

\item[Postpositions] are always subcategorized in two dimensions.
First subcategory is the syntactic category (POS) of the resulting
postpositional phrase, either an \emph{adjectival} or \emph{adverbial}
phrase, marked as \mtag[def]{Postp:adj} and \mtag[def]{Postp:adv}
respectively. Note that unlike other POS tags, these category
markers start with a lowercase letter.

Postpositions choose their noun phrase complements. Besides the
category of the resulting phrase, postpositions also include a tag
specifying the requirement for the complement noun phrase. The tag
marking required complement type is formed by a concise
description of the requirement followed by the capital letter `C'. The
postpositions that require the complement to be in \emph{ablative},
\emph{accusative}, \emph{dative}, \emph{genitive} and \emph{instrumental} cases are marked 
\mtag[def]{Postp:ablC},
\mtag[def]{Postp:accC},
\mtag[def]{Postp:datC},
\mtag[def]{Postp:genC},
and \mtag[def]{Postp:insC} respectively. The
postpositions that require the noun phrase to be suffixed with either
\sffx{lI} or \sffx{sIz} are marked with
\mtag[def]{Postp:liC}.\footnote{These suffixes are typically considered derivational suffixes, 
however their use resemble case markers.}
Postpositions that require
non-case marked complement are tagged \mtag[def]{Postp:nomC}.  Finally, postpositions that require numeric expressions as their
complements are marked with \mtag[def]{Postp:numC}.
For some the postpositions that take more than one type of noun complements,
TRmorph produces only the (presumably) most common option.
For example, the postpositions that are marked as \mtag{nomC} also take genitive marked pronouns as complements.
Similarly, postpositions \xmpl{önce} and \xmpl{sonra} that normally take ablative complements,
can also take bare (non-case-marked) numbers or time expressions.


\item[Numbers] are tagged as \mtag[def]{Num:ara} for Arabic numerals,
and \mtag[def]{Num:rom} for Roman numerals. Numbers that are spelled
out are not marked with a subcategory marker (but still marked as
\mtag{Num}). Besides numbers, the question word \xmplt{kaç}{how many}
is also tagged as a number with a sub tag specifying that it is a
question word, resulting in \mtag[def]{Num:qst}.

A rudimentary date/time recongnition is also supported.
Time expressions in 24-hour format with optional `seconds' field, 
i.e,  hh:mm(:ss) (also with separator `.'), 
and date formats of DD/MM/YYYY (also with separators `.' and `-' 
and YYYY-MM-DD are recognized as dates and times, 
and tagged as \mtag[def]{Num:time} and \mtag[def]{Num:date}, respectively.

\item[Verbs] are currently not subcategorized in TRmorph. 

Subcategorizing verbs as \emph{transitive} and \emph{intransitive}, or
marking all types (cases) of noun phrase complements a verb can take
is planned and some early steps are underway as of this writing (July
2013).
\item[Adverbs] are not currently subcategorized, except a few adverbial
question words for which the tag \mtag[def]{Adv:qst} is used.

% \item[Interjections] The question word \xmplt{hani}{where} is marked
% as an interjection as well as being marked as a \mtag{Prn:qst:loc},
% resulting in tag \mtag[def]{Ij:qst}. 
\item[Exist] The tag \mtag[def]{Exist} exists only for two words
\xmplt{var}{existent/present} and  \xmplt{yok}{non-existent/absent}. 
Since \xmpl{yok} is the negative of \xmpl{var}, it is tagged as
negative: \mtag[def]{Exist:neg}.
\end{description}

Some verbs, nouns, adjectives, adverbs and conjunctions are formed by
more than one written words. Some of these are adjacent words, like
the adverb \xmplt{apar topar}{hurriedly}, but some may be split like
the conjunction \xmpl{ya}, as in \xmplt{ya evdedir ya iş yerinde}{s/he
is either at home or the office}. Furthermore, some of individual
`words' in such constructions cannot be used by themselves, like
\xmpl{topar} above. If the non-split multi-word expressions are input
to the analyzer together, they are analyzed like other words of the
same class. However, if they are input word-by-word, a sub tag
\formattag{:partial} is added to the main POS tag. For example
\xmpl{apar} and \xmpl{topar} are tagged as \mtag[def]{Adv:partial} and
\xmpl{ya} is tagged as \mtag[def]{Cnj:partial} (more precisely
\mtag[def]{Cnj:coo:partial}). Currently, the tags
\mtag[def]{N:partial}, \mtag[def]{Adj:partial} and
\mtag[def]{V:partial} are used for parts of nouns, adjectives and
verbs respectively.

\subsection{Nominal morphology and noun inflections}

Nouns, pronouns, adjectives and adverbs in Turkish form the larger
class of nominals. Most adjectives, and some adverbs can function as
nouns (or pronouns). For example, \xmplt{mavi}{blue} may have a noun
reading `the blue one'. Similarly, some adverbs like
\xmplt{şimdi}{now} may take nominal inflections
\xmplt{şimdilerde}{now-PL-LOC = (literally) in current times}. In
TRmorph this is handled by allowing any adjective or adverb to become
an noun with a \emph{zero derivation}.\footnote{This certainly
generates incorrect analyses for a large number of adverbs which do
not `nominalize'.} A zero derivation is always marked with the tag
\mtag{0} followed by the new POS tag, in this case \mtag{N}. 

Nouns can be suffixed with the plural suffix, one of the possessive
suffixes and one of the case suffixes. All of these inflections are
optional. When not marked with any of these suffixes, the default is  singular, 
no possessive marking, an no case marking (or nominal), respectively.
When these suffixes  co-occur, they
have to occur in the order listed, shown in 
Figure~\ref{fig:noun-inflections}. The full list of noun inflections are
presented in Table~\ref{tbl:noun-inflections}.

\begin{figure}
\resizebox{\linewidth}{!}{%
\tikzinput{figures/nomfsa1}
}
\caption{\label{fig:noun-inflections}Automata depicting noun
inflections. The edge CASE1 represents the locative and 
ablative suffixes, CASE2 represents all other case-like suffixes. The
reason for the differentiation is due to the fact that the state
CASE1 can be followed by the suffix \sffx{ki}.}
\end{figure}

\begin{table}[t]
\caption{\label{tbl:noun-inflections} Noun inflections. }
\begin{center}
\begin{tabular}{llll}\toprule
\multicolumn{2}{l}{\textbf{Function}} & \textbf{surface} & \textbf{tag} \\
\toprule
\multicolumn{2}{l}{Plural} & \sffx{lAr} &  \mtag[def]{pl} \\
\midrule
\multirow{6}{*}{\rotatebox{90}{Possessive}}
&First person singular  & \sffx{(I)m} &  \mtag[def]{p1s} \\
&Second person singular  & \sffx{(I)n} &  \mtag[def]{p2s} \\
&Third person singular  & \sffx{(s)I} &  \mtag[def]{p3s} \\
&First person plural  & \sffx{(I)mIz} &  \mtag[def]{p1p} \\
&Second person plural  & \sffx{(I)nIz} &  \mtag[def]{p2p} \\
&Third person plural  & \sffx{lArI} &  \mtag[def]{p3p} \\
\midrule
\multirow{6}{*}{\rotatebox{90}{Case}}
&Accusative               & \sffx{(y)I}  & \mtag[def]{acc}\\
&Dative                   & \sffx{(y)A}  & \mtag[def]{dat}\\
&Ablative                 & \sffx{DAn}   & \mtag[def]{abl}\\
&Locative                 & \sffx{DA}    & \mtag[def]{loc}\\
&Genitive                 & \sffx{(n)In} & \mtag[def]{gen}\\
&Instrumental/commutative & \sffx{(y)lA} & \mtag[def]{ins}\\
\bottomrule
\end{tabular}
\end{center}
\end{table}

If there is a plural marker, analysis string after the \mtag{N} will
include the tag \mtag{pl}. TRmorph does not mark for singular. If a
noun is not marked for plural, it is assumed to be singular. 

%There are a small number of loan words that are plural in their
%language of origin, e.g., \xmplt{eşya}{belongings}. ...

The first five suffixes in the lower part of Table~\ref{tbl:noun-inflections} are commonly
recognized cases in Turkish. The \emph{instrumental/commutative}
marker also behaves like case suffixes. There are two more suffixes,
namely \sffx{lI} and \sffx{sIz} 
%(resembling to abessive case in its function), 
that can occupy the same slot, which are marked with tags
\mtag[def]{li} and \mtag[def]{siz} respectively.

Possessive markers follow either the nominal stem, or the plural marker. 
The basic function of the possessive markers are to mark a noun for possession.
That is a noun belonging to some entity, e.g., \xmplt{evi-m}{\emph{my} house} or \xmplt{ev-i}{\emph{his/her} house}.
Besides marking for possession, 
these suffixes, particularly the third person possessive suffix, 
have a number of other functions. 
The rest of this section explains some of these usage patterns, 
and how TRmorph represents them.

TRmorph normally does not allow adjectivals (adjectives, determiners and numbers) to take any of the possessive suffixes directly.
However an adjectival suffixed one the possessive suffixes may function as a pronoun. 
Examples include, 
\xmplt{üç-ümüz}{three of us}, 
\xmplt{bazı(lar)-ınız}{some of you} and
\xmplt{eski-si}{the old one (of them)}.
Note that this usage is different than possessively marked adjective 
with the noun interpretation, 
e.g., not `the three that belongs to us' but `three of us'.
In this use, possessive markers are treated like a derivational suffix.
The examples above would be analyzed as 
\mroot{üç}\mtag{Num}\mtag{p1p}\mtag{Prn},
\mroot{bazı}\mtag{Det:indef}\mtag{p1p}\mtag{Prn} and
\mroot{eski}\mtag{Adj}\mtag{p3s}\mtag{Prn},
respectively.


A similar usage is observed with verbal nouns and participles (see Section~\ref{ssec:subordination}).
In these cases the possessive marker marks the subject of the verb.
For example, in participle use of 
\xmplt{oku-yacağ-ım}{(the book) that I will read},
the possessive suffix marks who does the reading, 
and not a possession relation in the usual sense.
Currently trmorph analyzes this word as
\mroot{oku}\mtag{V}\mtag{part:fut}\mtag{Adj}\mtag{p1s}.

The \sffx{(s)I} suffix, listed as \mtag{p3s} in
Table~\ref{tbl:noun-inflections}, is highly ambiguous. One of its many
functions that may be confused with the possessive suffix is forming
noun compounds. In earlier versions of TRmorph, this function of
\sffx{(s)I} was always marked with the tag \mtag[def]{ncomp}. This
marker can be useful for marking noun compounds like \xmplt{at
araba\emph{sı}}{horse carriage}.\footnote{Even though one can assume
that this use is somewhat related to possession, it is not strictly
possessive marking (the horse does not own the carriage).
Furthermore, since a \sffx{(s)I} after another one is deleted on the
surface, a single \sffx{(s)I} suffix may also indicate a nominal
compound in possessive form (e.g., `someone's horse carriage').} In
this use, this tag always causes ambiguities. Besides the fact that a
noun suffixed with \sffx{(s)I} can either be marked for possession or
as the head of a noun compound, since one of the two \sffx{(s)I}
suffixes following each other is deleted from the surface form, it can
also be both (a noun compound marked for possession, \xmplt{at
araba\emph{sı}}{\emph{his} horse carriage}). In case any or the other
possessive markers are used with a noun compound, the suffix
\sffx{(s)I} is again deleted (e.g., \xmplt{at
araba\emph{nız}}{\emph{your} horse carriage}). In summary, marking
heads of nominal compounds are not straightforward during the
analysis. As a result this marker is a compile time option in the
current version (disabled by default). If not enabled, one should note
that the tag \mtag{p3s} may indicate a compound head with or without
third person singular possessive marking (see also the discussion of
ambiguity regarding \mtag{p3s} and \mtag{p3p} tags below).

Another issue with the \sffx{(s)I} suffix is that a noun marked with
\sffx{(s)I} may also indicate a third person plural possessor, e.g.,
\xmplt{onların araba\emph{sı}}{\emph{their} car}. In general, if there
is an overt possessor, the preferred third person plural marker is
\sffx{(s)I}, rather than \sffx{lArI}. TRmorph marks \sffx{(s)I} both
as \mtag{p3s} and \mtag{p3p}.

The case (or case-like) suffixes change the role of the noun (or the
noun phrase headed by the noun) in the sentence. For example a
locative marked noun phrase may function as an adverb (\xmpl{saat
dokuz\emph{da} görüşurüz}) or an adjective (\xmpl{yedi yaşın\emph{da}
çocuk}). However, following the common practice in the literature we
do not attempt to mark possible POS changes after case-like markers.

\subsection{\label{ssec:ki}The suffix \sffx{ki}}

The suffix \sffx{ki}, tagged as \mtag[def]{ki}, attaches to locative
or genitive marked nouns. The suffix may also attach to nouns expressing 
(a unit of) time, e.g., \xmplt{ay-ki}{month-ki}.\footnote{In this use,
the suffix affects a larger `time phrase', like \xmplt{bu yılki
üretim}{this-year's production}.} The resulting word functions as an
adjective or a pronoun. In both cases, TRmorph marks the transition to
an adjective. For example, \xmpl{evdeki} is analyzed as
`\mroot{ev}\mtag{N}\mtag{loc}\mtag{ki}\mtag{Adj}'. Since all adjectives are
allowed to become a noun through a zero derivation, the pronoun
reading is intended to be represented by this change. For example, the
intended analysis for \xmplt{evdeki kitap}{the book in the house} is
`\mroot{ev}\mtag[noindex]{N}\mtag[noindex]{loc}\mtag[noindex]{ki}\mtag[noindex]{Adj}',
while analysis for \xmplt{evdeki uyuyor}{the one/person in the house is
sleeping} appends \mtag{0}\mtag{N} at the end of the analysis
string.

The (pro)noun formed by \sffx{ki} can further be suffixed with other
nominal suffixes. Although the number of iterations using \sffx{ki}
rarely exceed two in practice, there is no principled limit.  As a
result, length of a Turkish word is in-principle unbounded. 

\subsection{\label{ssec:nompred}Tags related to nominal predicates}

Any nominal in Turkish may become a predicate with one of the
copular suffixes \sffx{(y)DI}, \sffx{(y)mIş}, \sffx{(y)sA} or
\sffx{(y)}. These suffixes correspond to \emph{past},
\emph{evidential}, \emph{conditional}, and \emph{present} predicates
involving the copula `be'. The copular markers has to precede one of
the verbal person agreement markers. For example
\xmplt{öğrenciy\emph{di}k}{we were students},
\xmplt{öğrenciy\emph{miş}ler}{they were [evidentially] students},
\xmplt{öğrenciy\emph{se}n}{if you are/were a student},
\xmplt{öğrenci\emph{y}im}{i’m a student}. Since the third person
singular agreement suffix is null on the surface and the buffer
\sffx{(y)-} does not surface in this case, any nominal without
additional copular or person suffixes serve as a nominal predicate
with present copula and third person singular agreement. Additionally,
since a predicate with third person singular agreement also agrees
with a third person plural subject, we additionally mark such a noun
as having present copula and third person plural agreement (for
example, \xmplt{babam öğretmen, annem ve ablam doktor}{my father is a
teacher, my mother and older sister are doctors}). 

TRmorph handles this process by allowing any noun and adjective to first became a verb with a zero derivation, 
and then marking it with the appropriate copula and the person agreement marker. The tags for
copula are \mtag[def]{cpl:pres}, \mtag[def]{cpl:past},
\mtag[def]{cpl:evid} and \mtag[def]{cpl:cond} for \emph{present},
\emph{past}, \emph{evidential} and \emph{conditional} copula
respectively. Last three tags are also possible after a verb with a
tense/aspect/modality suffix, and is discussed further in
Section~\ref{ssec:verbal-copula}.
Example analyses  for the examples discussed above would be as
follows:\\
\begin{tabular}{ll}
\xmpl{öğrenciydik}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:past}\mtag{1p}\\
\xmpl{öğrenciymişler}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:evid}\mtag{3p}\\
\xmpl{öğrenciysen}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:cond}\mtag{2s}\\
\xmpl{öğrenciyim}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:pres}\mtag{1s}\\
\xmpl{öğretmen}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:pres}\mtag{3s}\\
\xmpl{doktor}&\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:pres}\mtag{3p}\\
\end{tabular}


Besides copular suffixes, the suffix \sffx{(y)ken} (making adverbials
from verbs, discussed in Section~\ref{ssec:subordination}) may occupy
the same slot as the copular suffixes, although its use is more
restricted.

The nominal predicate with a copula and person agreement may be
followed by the marker \textcite{goksel2005} call `generalizing modality
marker', the suffix \sffx{DIr}. It is particularly common with
\mtag[noindex]{3s} as it disambiguates between the noun and the
predicate reading. The tag for this marker in TRmorph is
\mtag[def]{dir}.

\subsection{Number inflections}

The suffix \sffx{(ş)Ar}, tagged \mtag[def]{dist}, attached to numbers
form \emph{distributive} numerals. Besides the numbers (written as
numerals or spelled out), question word \xmplt{kaç}{how many} may also
get this suffix, and tagged with \mtag{dist}.

The ordinal numerals are formed using the suffix \sffx{-(I)ncI}, and
tagged as \mtag[def]{ord}. Ordinals are also specified by a `dot'
after Arabic or Roman numerals. TRmorph currently does not handle this
notation.

Percent sign before a numeral is treated like a prefix, and tagged as
\mtag[def]{perc}.

\subsection{Apostrophe behavior}

In written text an apostrophe is required after proper nouns and numbers
(official rules are more complicated).
However, the real-world use is rather relaxed, and people tend to omit the apostrophe.

Another difficult case for apostrophe is after the compound proper nouns, 
like \xmplt{Türkiye Büyük Millet Meclisi}{Grand National Assembly of Turkey}, 
\xmplt{Ağrı Dağı}{Mount Ararat} or 
\xmplt{Öfkeli Şirin}{Grouchy Smurf}.
Unless tokenized together, 
the analyzer cannot know that these words are part of a proper noun,
and parts of these compounds will be tagged as if they are single words. 
If the last noun in a compound is part of a proper noun, 
an apostrophe is required if further suffixes follow the last noun. 
TRmorph allows bare nouns, 
nouns with an \mtag{ncomp} tag or 
when \mtag{ncomp} is not enabled, nouns with a \mtag{p3s} tag
to have an optional apostrophe before other suffixes.
This behavior can be disabled during compile time in \lstinline{options.h}.

\subsection{Verbal voice suffixes}

Turkish verbs can be suffixed with one or more of the voice suffixes
\emph{reflexive}, \emph{reciprocal}, \emph{causative} and
\emph{passive}. The tags used for these functions are 
\mtag[def]{rfl},
\mtag[def]{rcp},
\mtag[def]{caus} and
\mtag[def]{pass}, respectively. The first two are rather unproductive
while causative and passive forms are productive. Furthermore,
causative suffix can be used repetitively.\footnote{Again, although this is
limited in practice, there is no principled limit on the number of causative
suffixes that one can string one after another.} With some verbs, use of double
causative suffix yields the same semantics as a single causative suffix. TRmorph does
not treat these cases separately. If surface string has double
causative suffixes, the analysis will include two \mtag{caus} tags,
regardless of its semantics.

Despite the fact that most grammar books list voice suffixes under
inflectional morphology, TRmorph treats them as derivations, i.e., a
\mtag{V} tag follows the voice related tags.

\subsection{Compound verbs}

A verbal stem (possibly including voice suffixes) may be followed by a
set of suffixes listed in Table~\ref{tbl:compound-verb} to form
compound verbs. These suffixes are related to some stand-alone verbs.

\begin{table}[t]
\caption{\label{tbl:compound-verb}Suffixes that make compound verbs.}
\begin{center}
\begin{tabular}{lll}\toprule
Suffix        & Tag             & Expresses\\
\toprule
\sffx{(y)Abil}& \mtag[def]{abil}& ability\\
\sffx{(y)Iver}& \mtag[def]{iver}& immediacy\\
\sffx{(y)Agel}& \mtag[def]{agel}& habitual/long term\\
\sffx{(y)Adur}& \mtag[def]{adur}& repetition/continuity\\
\sffx{(y)Ayaz}& \mtag[def]{ayaz}& almost \\
\sffx{(y)Akal}& \mtag[def]{akal}& stop/freeze in action\\
\sffx{(y)Agör}& \mtag[def]{agor}& somewhat like \mtag{iver}\\ % but used with conditional
%\sffx{(y)Akoy}& \mtag[def]{agor}& --\\
\bottomrule
\end{tabular}
\end{center}
\end{table}

The first three suffixes in this Table~\ref{tbl:compound-verb} are
relatively productive, the others are rare or their use are mostly
lexicalized. Although not frequent in use, more than one these
suffixes may attach to the same stem, for example
\xmplt{çıkıverebilir}{he/she/it may possibly come out/show up} analyzed
as `\mroot{çık}\mtag{V}\mtag{iver}\mtag{V}\mtag{abil}\mtag{V}\mtag{aor}\mtag{3s}'.

The form of \mtag{abil} in a negative verb is \sffx{(y)A}, and unlike
the rest of the suffixes listed in Table~\ref{tbl:compound-verb} it
follows the negative marker. 

Like the voice suffixes, we treat these suffixes as derivations,
starting a new verbal inflectional group. 

\subsection{The negative marker}

Negation of a verbal predicate is indicated with the suffix \sffx{mA},
and marked simply as \mtag[def]{neg}. Nominal predicates do not
get this suffix, instead the particle \xmpl{değil} is used.

\subsection{Tense/aspect/modality markers}

A verb with a set of suffixes described above either becomes a finite
verb by taking one of the tense, aspect and modality (TAM) markers
followed by a person-number agreement suffix, or it can be subject to
subordination and becomes nominalized.

The list of TAM suffixes, the corresponding tags and brief
descriptions are given in Table~\ref{tbl:tam}. 

\begin{table}[t]
\caption{\label{tbl:tam} Tense/aspect/modality markers. The usage of
suffix \sffx{(y)A} to express conditional aspect is informal, and
rather restricted. Aorist suffix is highly irregular. The choice of
\sffx{Ar} and \sffx{Ir} depends on the stem. The \sffx{z} form occurs
only after negative marker, and it is not realized on the surface if
it precedes first person agreement suffixes.}
\begin{center}
\begin{tabular}{lll}\toprule
Tag & Suffix & Description \\
\toprule
\mtag[def]{evid} &\sffx{mIş}     & evidential past (perfective)\\
\mtag[def]{fut}  &\sffx{(y)AcAk} & future \\
\mtag[def]{obl}  &\sffx{mAlI}    & obligative \\
\mtag[def]{impf} &\sffx{mAktA}   & imperfective \\
\mtag[def]{cont} &\sffx{(I)yor}  & imperfective \\
\mtag[def]{past} &\sffx{DI}      & past (perfective)\\
\mtag[def]{cond} &\sffx{sA},\sffx{(y)A} & conditional \\
\mtag[def]{opt}  &\sffx{(y)A}    & optative \\
\mtag[def]{imp}  &\sffx{}        & imperative \\
\mtag[def]{aor}  &\sffx{Ar},\sffx{Ir},\sffx{z},\sffx{} & aorist \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

\subsection{\label{ssec:pagr}Person and number agreement}

After TAM markers a finite verb requires one of the person and number agreement markers. 
For any finite predicate an agreement marker is compulsory.

Morphological tags for the agreement markers are composed of two characters, e.g., \mtag{1s} or \mtag{3p}.
The first character is a number indicating the person 
(\textbf{1}$^\textrm{st}$, 
\textbf{2}$^\textrm{nd}$ 
or \textbf{3}$^\textrm{rd}$),
and second one indicates the number (\textbf{s}ingular or \textbf{p}lural).
The surface form of the person-number agreement markers change depending on the suffixes they follow.  
Table~\ref{tbl:agreement} lists the person agreement markers and their surface forms according the TAM of the verb they attach to.
Note that the third person singular marker is null on the surface after most TAM markers.
Furthermore, since a predicate with third person singular marker will also agree with third person plural subject, 
all forms that are marked with a \mtag{3s} tag will also be marked with a \mtag{3p} tag.
A predicate with plural agreement marker may also indicate or agree with a singular subject in polite/formal speech.
However, TRmorph does not mark predicates with plural agreement markers with the \mtag{3s} tag.


\begin{table}[t]
\caption{\label{tbl:agreement}Person-number agreement markers. The suffixes listed in the column marked `TAM1' follow the TAM markers
\mtag{evid}, \mtag{fut}, \mtag{obl}, \mtag{impf} and \mtag{cont} as well
as the evidential copula \mtag{cpl:evid} and nominal predicates. 
The same set of suffixes also follow positive verbs with \mtag{aor}
without a negative marker. 
The suffixes on the column marked `TAM2' are used after \mtag{past} and
\mtag{cond} as well as the corresponding copular markers
\mtag{cpl:past} and \mtag{cpl:cond}.}
\begin{center}
\begin{tabular}{lllll}\toprule
Tag  & TAM1 & TAM2 & optative & imperative \\
\toprule
\mtag[def]{1s}&
    \sffx{(y)Im}     &\sffx{m}     &\sffx{(y)Im} & *\\
\mtag[def]{2s}&
    \sffx{sIn}       &\sffx{n}     &\sffx{sIn}   &\sffx{} \\
\mtag[def]{3s}&
    \sffx{}          &\sffx{}      &\sffx{}      &\sffx{sIn}\\
\mtag[def]{1p}&
    \sffx{(y)Iz}     &\sffx{K}     &\sffx{lIm}   & *\\
\mtag[def]{2p}&
    \sffx{sInIz}     &\sffx{nIz}  &\sffx{sInIz}  &\sffx{(y)In},\sffx{(y)InIz}\\
\mtag[def]{3p}&
    \sffx{lAr}       &\sffx{lAr}  &\sffx{lAr}    &\sffx{sInlAr},\sffx{}\\
\bottomrule
\end{tabular}
\end{center}
\end{table}

Although an agreement marker is required for a predicate,
TRmorph accepts a predicate with a TAM marker but without an agreement marker.%
\footnote{The agreement marker can be made compulsory through compile time options.}
There are a few cases where the agreement marker can be attached to somewhere else.
In a relatively common case, 
the agreement marker may be on the question particle 
(see Section~\ref{ssec:question}), as in 
\mtag{2s} suffix \sffx{sIn} in 
\xmplt{(partiye) gidecek- mı\textbf{sın}?}{will you go (to the party)?} 
(dash `-' indicates the expected position of the suffix in bold case).
Similarly, a verb may lack an agreement marker if it is part of a compound verb formed by free auxiliaries \xmpl{ol} and \xmpl{bulun}, 
for example \xmplt{gitmiş- bulun\textbf{duk}}{we happened to go},
or \xmplt{gidecek- olursa\textbf{nız} (üzülürüm)}{if you were to go (I'd be upset)}).%
\footnote{TRmorph currently does not treat or mark auxiliary verbs differently.
Although, there are some restrictions on the suffixes that can be attached to auxiliaries.
These two auxiliaries making verb-verb compounds, 
and another (about) 10 auxiliaries that make nominal-verb compounds may be marked as auxiliary in the future.}
Another case for predicates without agreement markers is `delayed suffixation' of coordinated predicates,
where only last predicate may have the agreement marker.
For example \xmplt{kahvaltı eder-, oltalarımızı alır-, balığa gider\textbf{iz}}{We have breakfast, take our hooks, and go fishing}.
Note that the predicates without agreement markers will also receive \mtag{3s} and \mtag{3s} analyses,
since a predicate with a null agreement suffix agrees with third person singular and plural subjects.
However, in all the examples above, tagging the main the predicates with third person markers would be incorrect.

One final note on agreement markers is that 
the subject--predicate agreement in Turkish is more complicated than simply matching agreement markers on subject noun phrase and the predicate
\parencite[see][chapter~5]{goksel2005}.
TRmorph marks nominals for number (if it is plural), but not for person, 
except in a few lexically specified cases, e.g., personal pronouns.
It would be easy to modify TRmorph to mark any noun that can become a subject
(typically no case marked nouns, but also genitive in some cases)
with third-person agreement.
However, utility of such a marker is not clear.

\subsection{\label{ssec:verbal-copula}Copular markers and \sffx{DIr}}

The copular suffixes discussed in Section~\ref{ssec:nompred} can also
be attached to a verb after a TAM marker, typically forming complex tenses. These
suffixes are \sffx{(y)DI}, \sffx{(y)mIş} and \sffx{(y)sA}, tagged as
\mtag[def]{cpl:past},
\mtag[def]{cpl:evid} and
\mtag[def]{cpl:cond}, respectively.

The conditional copula \sffx{(y)sA} can co-occur with other copular
markers. When there is a copular suffix, person-number agreement suffixes
normally attach after the first copula. However the third person
plural suffix may be after the TAM marker or second copular suffix as
well.

Similar to the nominal predicates with a copula, copular suffixes may
be followed the `generalizing modality marker' \sffx{DIr} tagged as
\mtag[def]{dir}.

\subsection{\label{ssec:question}The question particle}

Question particle \sffx{mI}, tagged as \mtag[def]{Q}, is normally written separately.
However, it has an intimate relationship with the verb or the nominal predicate it attaches to.
First, a few exceptions aside, it is attached to a tensed verb without a person
agreement.
In this case, the person agreement and the suffixes that may follow must be attached to the question particle.
In this particular case, the verb will often be analyzed wrongly as having the
agreement marker \mtag{3s} or \mtag{3p},
since a predicate with null person agreement suffix may agree with third person singular or plural subjects.
Second, the question particle follows the vowel harmony rules,
and the underspecified vowel on \sffx{mI} is realized based on the last vowel of the verb.
As a result the question particle can only be analyzed (and generated) with precision only together with the word it is attached to.

If tokenized together with the predicate,
TRmorph will swallow the space in between the predicate and the \sffx{mI} and analyze it altogether.
In this case the lowercase tag \mtag[def]{q} is used.
Furthermore, it is a common spelling mistakes to write the question particle together with the related word.
TRmorph can be instructed to to
accept this common mistake during compile time, in which case the tag
will again be \mtag{q}.

\subsection{\label{ssec:subordination}Subordination}

A set of suffixes attached to an `untensed' verb, a verb without any
TAM markers, result in the phrase headed by the verb to become a
subordinate clause. TRmorph follows the description in
\textcite{goksel2005}, and makes the distinction between three different
forms of subordination. First, a set of suffixes produce \emph{verbal
noun}s from a non-finite verb. The resulting words function as the
head of the noun phrases,
and with some limitation they can receive all nominal inflections. The
second group forms \emph{participles}, which form relative clauses.
Participles can also take nominal inflections with few
restrictions. The last group, \emph{converbs}, form adverbials and
they are more restricted in terms of the morphemes attached to
them. The suffixes that form forms different types of subordinating
suffixes overlap significantly. As a result, producing ambiguous
analyses.

TRmorph uses the tag structure \formattag{type:subtype} for marking
subordinating suffixes. The first part, \texttt{type}, is one of
\texttt{vn}, \texttt{part} and \texttt{cv} for verbal nouns,
participles and converbs, respectively. The second, \texttt{subtype}, 
part indicate a further distinction of the function of the suffix,
a relevant linguistic abbreviation, but sometimes a version of the
surface form of the suffix. The tags used for all three types of
subordinating suffixes are listed in Table~\ref{tbl:subord}.

Since verbal nouns, participles and converbs derive nominal, adjectival
and adverbial phrases, respectively, POS tags, \mtag{N}, \mtag{Adj}
and \mtag{Adv}, follow these tags.

\begin{table}[t]
\caption{\label{tbl:subord}Subordinating suffixes and tags used for
subordinating suffixes.}
\begin{center}
\begin{tabular}{ll}\toprule
Tag         & Suffix     \\
\toprule
\mtag[def]{vn:inf}      &\sffx{mA}  \\
\mtag[def]{vn:inf}      &\sffx{mAK}    \\
\mtag[def]{vn:yis}      &\sffx{(y)Iş}   \\
\mtag[def]{vn:past}     &\sffx{DIk} \\
\mtag[def]{vn:fut}      &\sffx{(y)AcAk} \\
\mtag[def]{vn:res}      &\sffx{(y)An}   \\
\midrule
\mtag[def]{part:past}   &\sffx{DIk} \\
\mtag[def]{part:fut}    &\sffx{(y)AcAk} \\
\mtag[def]{part:pres}   &\sffx{(y)An}   \\
\midrule
\mtag[def]{cv:ip}       &\sffx{(y)Ip}   \\
\mtag[def]{cv:meksizin} &\sffx{mAksIzIn}    \\
\mtag[def]{cv:ince}     &\sffx{(y)IncA} \\
\mtag[def]{cv:erek}     &\sffx{(y)ArAk} \\
\mtag[def]{cv:eli}      &\sffx{(y)AlI}  \\
\mtag[def]{cv:dikce}    &\sffx{DIkCA}   \\
\mtag[def]{cv:esiye}    &\sffx{(y)AsIyA}    \\
\mtag[def]{cv:den}      &\sffx{dAn} \\
\mtag[def]{cv:den}      &\sffx{zdAn}    \\
\mtag[def]{cv:cesine}   &\sffx{CAsInA}  \\
\mtag[def]{cv:ya}       &\sffx{(y)A}  \\
\mtag[def]{cv:ken}      &\sffx{(y)ken}  \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

Some of the suffixes have multiple functions and may derive more than
one type of subordinate clauses. Furthermore, TRmorph will produce some
spurious ambiguity because of the fact that any adjective, hence a
word suffixed with an participle, is allowed to become a noun with a
zero derivation.

The list in Table~\ref{tbl:subord} follows \textcite{goksel2005}. The main
exception is the suffixes listed by \textcite{goksel2005} as converbial
suffixes that require a postposition. Since the postposition in these
cases will signal the adverbial function of postpositional phrase,
TRmorph does not mark the complement of the postposition as a converb.

%
% TODO: another review to see if all of them are accepted as they
% should be.
%

Most of these suffixes attach to an untensed verb. Except, the suffix
\sffx{(y)ken} which behaves much like the copular suffixes discussed
above. Furthermore, the \sffx{(y)A} in its subordinating function
is typically used together with reduplication, e.g., \xmplt{koşa
koşa}{run-(y)A run-(y)A = hurriedly}, but also occurs in words like
\xmpl{diye}, where it does not need reduplication.%
\footnote{We also analyze \xmpl{diye} as a postposition, 
as its use as subordinator is semantically unlike the others uses of \sffx{(y)A}.}

Besides the subordinating suffixes (participles) discussed above, 
some of the TAM markers, 
namely \mtag{aor} (\sffx{Ar}/\sffx{Ir}), \mtag{evid} (\sffx{mIş}) and \mtag{fut} (\sffx{AcAk}),
derive adjectives from verbs.%
\footnote{Although they differ in usage, 
these forms have the same semantics as 
the verb-verb compounds formed by the auxiliary auxiliary verb \xmpl{ol} with present participle suffix (\xmpl{ol-an}).}
TRmorph handles this by analyzing any verb with one of these TAM markers without further suffixes 
(e.g., agreement markers) as an adjective. 
For example, the word 
\xmpl{görülmüş} in 
\xmplt{görülmüş mektup}{see-PASV-EVID letter = the letter that was seen} 
is analyzed as
`\mroot{gör}\mtag{V}\mtag{pass}\mtag{V}\mtag{evid}\mtag{Adj}'.

\subsection{Productive derivational morphemes}

\begin{table}[h]
\caption{\label{tbl:deriv}Derivational morphemes analyzed by TRmorph.
The column `Derivation' lists the POS changes using a two letter
symbols. The first letter is the original POS, and the second one is the
POS after the suffixation. Here, 
\texttt{N},
\texttt{J},
\texttt{A},
\texttt{M},
\texttt{V},
\texttt{I} 
and 
\texttt{O} 
stand for noun, adjective, adverb, number, verb interjection and onomatopoeia, respectively.}
\begin{center}
\begin{tabular}{lll}\toprule
Tag              & Suffix        & Derivation \\
\toprule
\mtag[def]{li}   & \sffx{lI}     & NA NJ \\
\mtag[def]{siz}  & \sffx{sIz}    & NA NJ \\
\mtag[def]{lik}  & \sffx{lIk}    & NN JN AN \\
\mtag[def]{dim}  & \sffx{CIk}    & NN \\
                 & \sffx{cAk}    & \\
                 & \sffx{(I)cAk} & \\
                 & \sffx{cAğIz}  & \\
\mtag[def]{ci}   & \sffx{CI}     & NN NJ \\
\mtag[def]{arasi}& \sffx{arası}  & NJ \\
\mtag[def]{imsi} & \sffx{(I)msI} & NJ JJ\\
\mtag[def]{imtrak} & \sffx{(I)mtrak} & NJ JJ\\
\mtag[def]{si}   & \sffx{sI}     & NJ \\
\mtag[def]{ca}   & \sffx{CA}     & NA AA JJ MJ \\ 
\mtag[def]{cana} & \sffx{CAnA}   & AA JA \\ 
\mtag[def]{yici} & \sffx{(y)IcI} & VJ \\
\mtag[def]{cil}  & \sffx{CIl}    & NJ \\
\mtag[def]{gil}  & \sffx{gil}    & NN \\
\mtag[def]{lan}  & \sffx{lAn}    & JV \\
\mtag[def]{las}  & \sffx{lAş}    & NV JV \\
\mtag[def]{yis}  & \sffx{yIş}    & VN \\
\mtag[def]{esi}  & \sffx{(y)AsI} & VJ \\
\mtag[def]{sal}  & \sffx{sAl}    & NJ \\
\mtag[def]{la}   & \sffx{lA}     & NV  JV OV IV\\
\mtag[def]{dir}  & \sffx{DIr}    & NA \\
\mtag[def]{leri} & \sffx{lArI}   & AA \\
\bottomrule
\end{tabular}
\end{center}
\end{table}

Almost all the tags and relevant morphological process above are
described as part of inflectional morphology in most grammar books.
The suffixes described here are the ones that are traditionally
considered derivational suffixes. Some of these suffixes, for example
\sffx{lI} and \sffx{sIz} discussed earlier, may attach to word forms
that are already inflected by other suffixes. Others normally attach
only to the stem and produce another stem.

The derivational suffixes analyzed by TRmorph are listed in Table~\ref{tbl:deriv}.
Of these suffixes, \sffx{lA} causes a large number of ambiguous analyses 
since it is part of a few other suffixes, 
for example, the plural suffix \sffx{lAr}.
In case of \sffx{lAr}, whose remainder \sffx{r} also matches a verbal suffix (aorist marker),
any plural noun is analyzed as a verb as well.
For example, the word \xmpl{kanıtlar} is analyzed as \mroot{kanıt}\mtag{N}\mtag{pl} `evidence-PLU', or \mroot{kanıt}\mroot{N}\mtag{la}\mtag{V}\mtag{aor}\mtag{3s} `(s)he proves (it)'.
Hence, including \sffx{lA} in the analysis causes an increase in the number of analyses produced by TRmorph.
The analysis of the suffix \sffx{lA} can be disabled during the compile time.
In this case, a separate lexicon containing verbs with derivational suffix \sffx{lA} will be included in the root lexicon.
Some of the `lexicalized' verbal stems that end in \sffx{lA} are included in the main lexicon,
and will result in an analysis with a stem including \sffx{lA} regardless of this option.
Similarly, \sffx{lA} is always accepted on onomatopoeic roots and interjections.

In some cases the derivational suffixes can only be attached to a subset of the words within the word class.
Not all these cases are easy to identify, 
and TRmorph will analyze combinations of stems and suffixes that are not in the language.
Furthermore, TRmorph does not limit the number of derivational suffixes that can be stringed one after another other, 
even though multiple derivations of this sort is a lot more restricted. 

Besides the sources of possible erroneous over-analyses listed above,
the derivational morphology specification in TRmorph over-generates in
some cases. In particular, any form of the diminutive suffix is
allowed to attach to any noun, although most nouns are used only one
of the diminutive suffixes. The ambiguity and overgeneration are
discussed in Section~\ref{sec:ambiguity}.


\section{\label{sec:lexicon}The lexicon}

TRmorph contains a root lexicon which is created extracting root forms
from a large web corpora, and checking the possible forms against
online dictionaries, and the lexicon of the earlier version which was
based on Zemberek \parencite{akin2007}. The result is also checked and
corrected manually as part of the development process. 

The lexicon files are located under the directory \lstinline{lexicon}
and included (through C preprocessor) as a single root lexicon. The
files under \lstinline{lexicon/} are simply a list of root forms and
their \emph{continuation classes}. Continuation classes can be any
\lstinline{LEXICON} declaration in the file \lstinline{morph.lexc},
but typical continuation classes are the main word (POS) categories,
such as \texttt{N}, \texttt{Adj} and \texttt{V}. The lexical
exceptions are specified after the main category information. For
example, \texttt{V\_AorAr} for verbal roots that take the exceptional
\sffx{Ar} form of the aorist suffix. Likewise, \texttt{N\_comp} is
used for lexicalized nominal \sffx{sI} compounds since when these
words are pluralized the plural marker is inserted between the word
and the suffix \sffx{sI}.

The lexical forms are similar to the written forms of the relevant
stem. However, a set of special `multi-character' symbols are used for
providing information necessary for morphophonological processing.  A
large group of these symbols are concerned with `final stop devoicing'
(or voicing depending on your view point). The consonants \texttt{ç},
\texttt{t}, \texttt{k}, \texttt{p} and \texttt{g} at the end of some
of the roots are replaced with their voiced counterparts if they
precede a suffix that starts with a vowel. These root forms are
lexically marked by replacing the consonants above with
multi-character symbols \texttt{\^{}c}, \texttt{\^{}t}, \texttt{\^{}k},
\texttt{\^{}p} and \texttt{\^{}g}, respectively. 

%\texttt{\^{}K}, \texttt{\^{}C}, \texttt{\^{}D}

Besides the voicing changes of consonants, some borrowings end with a
`palatalized' consonant that affects vowel harmony process. For
example \xmplt{saat}{watch/clock} is inflected as
\xmplt{saat-i}{watch-ACC} instead of \xmpl{saat-ı} as vowel harmony
suggests. These words are indicated by the vowel before such a
consonant by a three-letter multi-character symbol. These symbols
always start with \texttt{\^{}p} and a capitalized version of the
relevant vowel. For example, the word \xmpl{saat} is listed as
\texttt{sa\^{}pAt} in the lexicon.

One last class of similar special symbols are so-called \emph{silent
vowels and consonants}. These are particularly useful for
abbreviations and numerals, but also some names of foreign origin. The
suffixes that follow such words are also subject to
morpho-phonological process like vowel harmony. However, this cannot
be derived from their written form. For example correct inflected form
of \xmplt{ABD-DAT}{USA-DAT} is \xmpl{ABD'ye}, not \xmpl{ABD'ya}. The
way to solve this problem is to insert a silent (front-unrounded)
vowel after the abbreviated form. The multi-character symbols
\texttt{\^{}sBUV} \texttt{\^{}sBRV} \texttt{\^{}sFUV} \texttt{\^{}sFRV}
\texttt{\^{}sVC} and \texttt{\^{}sUC} are used for silent vowels and
consonants (see the comments in file \lstinline{lexicon/abbreviation}
for more information).

A somewhat inconsistent notation is used for three morphological
processes. First, the multi character symbol \texttt{@DEL@} is
inserted before a vowel that is deleted if a suffix starting with a
vowel follows. Second, the last consonant in some borrowings are
duplicated if they follow a suffix that start with a vowel. These root
forms are marked by inserting the multi-character symbol
\texttt{@DUP@} before the duplicated consonant. And the last symbol
\texttt{@DELS@} is used in lexical entries of a few borrowed words
which delete \texttt{s} in the suffix \sffx{sI}.\footnote{These
multi-character symbols are both inconsistent with the others, and
they may be confused with `flag diacritics' at first sight (TRmorph 
does not use any flag diacritics). This notation in the lexicon may
change in the future version of TRmorph.}


\section{\label{sec:ambiguity}Ambiguity and overgeneration}

This section
discusses the ambiguous analyses in TRmorph, and also touches upon a
related but different problem, overgeneration.

The morphological analysis of Turkish text is an inherently ambiguous
process. However, the design choices made in a morphological analyzer
affects the number of ambiguous analyses produced per word.  TRmorph,
by design, does not try to reduce the number of ambiguous analyses. In
general, TRmorph produces more ambiguous analyses than the others
(mainly based on \textcite{oflazer1994}) reported in the literature. 

The following is a list of cases where one finds ambiguous
morphological analyses in TRmorph. Some of these cases are not
specific to TRmorph, and for example, noted by \textcite{oflazer1997} as
well. This list may be useful for the users who may wish to
disambiguate the output of the analysis using rule-based methods, or
it may also be useful in the process of designing statistical
disambiguators.

\begin{enumerate}
\item Ambiguous root forms, for example \emph{yüz} can be analyzed as:
    \begin{enumerate}
        \item \mroot{yüz}\mtag{N} `face'
        \item \mroot{yüz}\mtag{Num} `hundred'
        \item \mroot{yüz}\mtag{V}\mtag{imp}\mtag{2s} `swim'
    \end{enumerate}
\item\label{itm:buna} A root form is the same as a shorter root and one or more
suffixes, for example \emph{buna} can be analyzed as
    \begin{enumerate}
        \item \mroot{bu}\mtag{Prn:dem}\mtag{dat} `this-DAT'
        \item \mroot{buna}\mtag{V}\mtag{imp}\mtag{2s} `become senile-IMP'
        \item \mroot{bun}\mtag{N}\mtag{dat}   `trouble-DAT'
    \end{enumerate}
Note that the root `bun' is a very rare/regional word, and the imperative
verb reading is also very unlikely. However the best option
for the analyzer is to produce all these analyses, and let the later
stages analysis disambiguate between them.

\item\label{itm:sub-suffix} The surface form of a suffix is a combination of two other suffixes. For example, the word \xmpl{evleri} can be
    \begin{enumerate}
        \item ev\sffx{leri} `\mroot{ev}\mtag{N}\mtag{p3p} = their house'
        \item ev\sffx{ler}\sffx{i} `\mroot{ev}\mtag{N}\mtag{pl}\mtag{acc} = houses-ACC'
    \end{enumerate}
Furthermore, the same word can also be analyzed as 
    \begin{enumerate}
        \item \mroot{ev}\mtag{N}\mtag{pl}\mtag{p3s}
    \item \mroot{ev}\mtag{N}\mtag{pl}\mtag{p3p}
    \item \mroot{ev}\mtag{N}\mtag{ncomp}\mtag{p3p}
    \item \mroot{ev}\mtag{N}\mtag{ncomp}\mtag{pl}
    \item \mroot{ev}\mtag{N}\mtag{ncomp}\mtag{pl}\mtag{p3p}
    \item \mroot{ev}\mtag{N}\mtag{ncomp}\mtag{pl}\mtag{p3s} 
    \item \mroot{ev}\mtag{N}\mtag{ncomp}\mtag{pl}\mtag{p3p}
    \end{enumerate}
The reason for these analyses has to do with the sources of ambiguity explained in items \ref{itm:different-func} and \ref{itm:null-suffix}.
\item An analysis with multiple morphemes is also a (derived) lexicalized form. For example the word \xmpl{konuşma} can be analyzed as 
    \begin{enumerate}
        \item \mroot{konuşma}\mtag{N} `speech'
        \item \mroot{konuş}\mtag{V}\mtag{vn:inf}\mtag{N}  infinitive `to speak', e.g., as in \xmplt{konuşmamızı isemiyorlar}{The do not want us \emph{to speak}}
        \item \mroot{konuş}\mtag{V}\mtag{neg}\mtag{imp}\mtag{2s} `speak-NEG-IMP = don't talk'
    \end{enumerate}
\item\label{itm:same-surface} different affixes surfacing the same way, \emph{evin} can be
    \begin{enumerate}
        \item ev\sffx{(n)In} `\mroot{ev}\mtag{N}\mtag{gen} =of the house'
        \item ev\sffx{(I)n}  `\mroot{ev}\mtag{N}\mtag{p2s} =your house'
    \end{enumerate}
\item\label{itm:different-func} The same surface suffix has multiple
functions. For example, the word \xmpl{doktorlar} can be,
    \begin{enumerate}
        \item \mroot{doktor}\mtag{N}\mtag{pl} `doctors'
        \item \mroot{doktor}\mtag{N}\mtag{0}\mtag{V}\mtag{cpl:pres}\mtag{3p} `they are doctors'
    \end{enumerate}
\item\label{itm:3p-3s} The suffix \sffx{(s)I} that marks third person
singular possessive and the null suffix that marks third person
singular subject--predicate agreement may also have third person
plural readings. For example,
    \begin{enumerate}
    \item The word \xmpl{ev-i} can both mean `his/her house'
        (\mroot{ev}\mtag{N}\mtag{p3s}) as well as `their house' (\mroot{ev}\mtag{N}\mtag{p3p}).
    \item A verb like \xmplt{okudu}{read-PAST} with no overt
    agreement marker may agree with a third person singular or plural
    subject. Hence, it is analyzed with 
    both singular (`he/she read-PAST' \mroot{oku}\mtag{V}\mtag{past}\mtag{3s}) 
    and plural (`he/she read-PAST' \mroot{oku}\mtag{V}\mtag{past}\mtag{3p}) 
    third person agreement markers.
    \end{enumerate}

As a result, any predicate with a null agreement will have two
analyses one with  \mtag{3s} and the other with \mtag{3p} agreement
tags. Similarly any noun with suffix \sffx{(s)I} will have two
analyses, one with \mtag{p3s} and the other with \mtag{p3p}. These
analyses will be multiplied with \mtag{ncomp} if the optional noun
compound head marker is enabled during the compile time.

\item\label{itm:null-suffix} Some suffixes are not realized on the surface in the neighborhood of some other suffixes. These are generally, but not always, the suffixes having the same or similar surface forms. For example, \xmpl{evleri} (the example in item \ref{itm:sub-suffix}) may be analyzed as
    \begin{enumerate}
        \item \mroot{ev}\mtag{N}\mtag{p3p}  as in \xmplt{Annem ve babamın evleri Istanbul'da}{My parents' house is in Istanbul}
        \item \mroot{ev}\mtag{N}\mtag{pl}\mtag{p3p} as in \xmplt{Annem ve babamın bütün evleri deniz manzaralı}{All houses of my parents have a see view}.
    \end{enumerate}
since in case of \mtag{pl} (\sffx{lAr}) and \mtag{p3p} (\sffx{lArI})
are combined, the plural suffix \sffx{lAr} does not realized on the
surface.\footnote{One can also explain this as \mtag{p3p} being
realized as \sffx{I} in this particular context.}

This particular source causes an extremely large number of ambiguous
analyses because the multi functional suffix \sffx{(s)I} is omitted in
case it precedes (or follows) another \sffx{(s)I}, but also a
\sffx{lArI}, \sffx{lI}, \sffx{lIk}, \sffx{sIz}, \sffx{CI} or
\sffx{CIk}. Since some of these suffixes may follow each other, and
\sffx{(s)I} itself has multiple functions, a word like
\xmpl{bağım-sız-lık-çı-lığ-ı-nı} causes a combinatorial expansion of
ambiguous analyses because of the fact that at every suffix boundary
marked with a dash in the example there may be a \sffx{(s)I} suffix
being deleted. This is further amplified by the fact that \sffx{(s)I}
may express \mtag{ncomp} or \mtag{p3s} and any of the resulting
words may also have a null suffix expressing third person singular or
plural agreement on a nominal predicate.\footnote{Most straightforward
reading of the word is dative form of the noun phrase can roughly be
translated as `his/her state of being a supporter of independence'.
With this root, The total number of analyses is 25560.} Most of
these analyses will be semantically not plausible. However, there is
no clear way of ruling them out at the analysis stage. The following
illustrates the problem with a more tangible example, using the word
\emph{arabasız} which can be analyzed as one of the following (and
more).

\begin{enumerate}
    \item[(c)] \mroot{araba}\mtag{N}\mtag{siz}\mtag{Adj} `without a car'
    \item[(d)] \mroot{araba}\mtag{N}\mtag{p3s}\mtag{siz}\mtag{Adv} `without a his/her car'
    \item[(e)] \mroot{araba}\mtag{N}\mtag{ncomp}\mtag{siz}\mtag{Adv}, e.g., in \xmplt{at arabasız}{without a horse carriage}
    \item[(f)] \mroot{araba}\mtag{N}\mtag{ncomp}\mtag{p3s}\mtag{siz}\mtag{Adv}, e.g., in \xmplt{at arabasız}{without his/her horse carriage}
\end{enumerate}

\end{enumerate}

Besides the ambiguity described above, overgeneration is another
problem that one faces when the FST is used for generating surface
forms. Unlike analysis, generation is almost always deterministic in
Turkish.
Nevertheless, there are a few cases where TRmorph produces multiple
surface strings for a single analysis string. The following provides a
(likely incomplete) list of cases where TRmorph is expected
to overgenerate, i.e., either produce multiple (correct) surface
strings for the same input, or produce incorrect surface strings in
generation mode.

\begin{enumerate}
\item One of the clear cases where overgeneration occurs is
the diminutive, \mtag{dim}. The diminutive suffix in Turkish is one of
\sffx{CIk}, \sffx{cAk}, \sffx{(I)cAk}, \sffx{cAğIz}. TRmorph allows
attaching any of these suffixes to any noun. This is
unlikely to cause problems during the analysis. However, it will
certainly produce incorrect surface forms.

\item The \mtag{p3s} suffix \sffx{(s)I} may also be used for marking
third person plural possessive (\mtag{p3p}). For example \xmpl{ev-i}
in \xmplt{Ali ve Ayşe'nin evi}{The house of Ali and Ayşe} should be
tagged as \mtag{p3p}. On the other hand, the suffix \sffx{lArI} is
also used to express \mtag{p3p}. As a result any analysis string with
the symbol \mtag{p3p} will generate both surface options.

\item A similar case of overgeneration is with the null agreement
suffix which should generally be tagged as \mtag{3s}. However, such a predicate may
also agree with a \mtag{3p} subject. Consequently, a null-agreement
suffix on a predicate is tagged as both \mtag{3s} and \mtag{3p}. Since
\mtag{3p} can also be expressed with the suffix \sffx{lAr}, a analysis
string with \mtag{3p} also generates multiple surface forms.

\item Another known case of overgeneration is related to the relaxed
analysis of alternative spellings or common misspellings. In the simplest case, every
word will be generated once capitalized and once all lowercase. If
`all capitals' option is enabled, another surface form which is in all
capital letters will be produced. 

\item Similarly, if the analyzer is instructed to accept the proper
noun suffixes without an apostrophe, in the generation mode the surface
form with and without apostrophe will be included. As a result, some
of the options may need to be tuned if the FST is to be used for
generation.

\item Some symbols, like apostrophe have multiple representations in
Unicode definition. As a result, any word that require an apostrophe
will result in surface form for each alternative symbol.

\item After a small set of borrowings like \xmplt{cami}{mosque}, the
`s' in the suffix \sffx{(s)I} is deleted according to official rules.
However, this seems to be out of fashion in current use, and use of
`s' (even in text) is more common that its deletion. Since TRmorph
accepts both surface strings, this will cause generating multiple
strings.

There are also a few other cases where some (sizable number of)
speakers diverge from the canonical forms. An example is the redundant
use of genitive suffix after a pronoun, before the suffix
\sffx{(y)lA}, e.g., the surface form of
`\mroot{sen}\mtag{Prn:pers:1s}\mtag{ins}' should be \xmpl{sen-in-le} where the
suffix \sffx{in} is redundant. Some speakers tend not to use \sffx{in}
in such constructions. TRmorph accepts both use, hence the generation
will be ambiguous.

\item Some borrowed words include a few vowels with circumflex, namely
\xmpl{â},
\xmpl{û} and
\xmpl{î}. Except for a few words where use of circumflex helps
disambiguation between different words, these vowels have been replaced by their
non-circumflexed version in modern use. TRmorph allows this
replacement even if the lexical form of the word should include a
circumflex.\footnote{One can also allow circumflexed vowels
to be used for their non-circumflexed counterparts in the lexicon. This is useful if one needs to
analyze somewhat older text. Enabling this option will also cause
overgeneration.} This also results in overgeneration, since any
analysis string with a circumflexed vowel will have a surface form
with and without circumflex.

\end{enumerate}

\section{\label{sec:other-tools}Other tools}

\subsection{Stemming and lemmatization}

In morphologically complex languages like Turkish, proper stemming
requires analyzing the given word and stripping off the analysis
symbols such that only the stem remains.

Although one can do this easily by filtering analyzer output, TRmorph
includes a simple wrapper automaton for convenience. The
automaton is defined in the file \lstinline{stemmer.fst}. You need to
type \lstinline{make stemmer} to produce the binary
\lstinline{stem.fst}. This binary file can be used the way analyzer is
used. Given a surface word, this automaton will produce the lexical
form as the analysis string.

Optionally, one can keep the first tag, which is the syntactic
category of the stem. Note that stemmer takes the lexical form as the
`stem', even if the lexical form has derivational suffixes immediately
following the root form.
Another compile time option related to stemmer causes the verbs to be
suffixed with correct form of infinitive marker \sffx{mAk}. This form
of the verbs are what the dictionaries use as head words. Both options
can be set in the file \lstinline{options.h}.

Note that ambiguity is less of a problem for the stemmer. However,
in examples like \xmpl{buna} discussed on page~\pageref{itm:buna},
there will be multiple stem forms produced (\xmpl{bu}, \xmpl{bun} and
\xmpl{buna} in this case).

\subsection{Unknown word guesser}

TRmorph includes a rudimentary guesser for guessing unknown words. To
produce the automaton for this function, you should type
\lstinline{make guesser}, which would produce the file
\lstinline{guess.fst}. The usage of the automaton is again similar to
the others. The surface strings of the FST is the (unknown) words,
while analysis level is either the full analysis strings with possibly
unknown root words that may lead to the surface form, or only the root
word and its part of speech tag.

The guesser uses the same machinery as the analyzer, except the
lexicon is replaced with a FSA that accepts a somewhat restricted set
of strings as potential words. Since unknown words will likely include
affixes, one may have a better chance of determining the root form of
the word, and in most cases the class of the root word.

Depending on its application, the guesser be restricted further
according to features of the words that can be coded into a finite
state lexicon. For example, one may check whether the words fit into
the syllable structure of the language, but this may miss the words of
foreign origin, which are likely candidates for being unknown words.
Currently only general restriction the guesser include the minimum
and maximum root-word length that can be set in the file
\lstinline{options.h}.

The guesser may also be adjusted to
return full analysis string(s) or only the root form followed by the
POS tag. Again, these options can be set in \lstinline{options.h}.
Other customizations can be achieved by adjusting the file
\lstinline{guesser.lexc}.

The guesser is a standalone FST, 
to use it in combination with the analyzer, 
two automata can be combined with \emph{priority union} such that guesser is only invoked if the analyzer fails. 
An example script that combines analyzer and guesser is provided with the name \lstinline{anlyze_guess.xfst}.
The resulting binary will be called \lstinline{anlyze_guess.fst}.
This binary is also built by default if the guesser is build by \lstinline{make guesser}.
By default the script puts two FST's without priority union to a single file.
Hence, a command line like \lstinline{flookup -a analyze_guess.fst} will simulate the priority union.
Example command for building a single automaton combining the analyzer and the guesser with priority union is provided in \lstinline{anlyze_guess.xfst}.

\subsection{Morphological segmentation}

Morphological segmentation is the task of finding morpheme boundaries
on the surface strings. TRmorph distribution includes an automaton
description for segmenting the words into their morphemes.  To build
the segmenter you need to type \lstinline{make segmenter} and the
resulting binary will be called \lstinline{segment.fst}.

TRmorph marks the root and morpheme boundaries on the surface string
to aid morpho-phonological rules. These boundaries are deleted from
the surface string in the normal analyzer FST. The segmentation FST
relies on this and the following trick for segmenting a given word to
its surface morphemes: The given input string is first analyzed with
the regular analyzer FST. Then the analysis strings are passed to a
slightly modified FST in generation mode, which does not delete the
boundary markers from the surface string. 

It should be noted that the surface morpheme boundaries are not always
determined uniquely. It is especially difficult to decide whether some
buffer vowels or consonants belong to the morpheme preceding or
following them. TRmorph consistently attaches these buffer letters to
the morpheme that follow the boundary.

Because of the way it is implemented currently, the segmenter output needs to be post
processed to obtain the desired result. The segmenter will produce
multiple identical segmented strings, and there will also be some
incorrect segmentations due to overgeneration discussed in
Section~\ref{sec:ambiguity}. The output should be post-processed to
remove multiple identical segmentations.
The incorrect segmentations due to 
overgeneration can be eliminated by comparing the segmented string
with the original one. An example post processing script is provided
as \lstinline{scripts/segment-filter.py}.


\subsection{Hyphenation and syllabification}

Hyphens in Turkish are inserted at the syllable boundaries.  Because
of the regular syllable structure and transparency of the orthography,
this process does not require any dictionary lookup, or morphological
analysis. Since the hyphenation problem is easy to solve with a FST, a
stand alone FST defined in xfst language included in the TRmorph
distribution.

To build the hyphenation FST you need to type 
\lstinline{make hyphenate} and the resulting binary will be called
\lstinline{hyphenate.fst}.

The surface string of the FST is Turkish words (or strings resembling
words) and analysis string is the words where a hyphen `-' is inserted
between the syllables, or at the points where one can insert a hyphen.

\subsection{Analysis string converters}

The distribution also includes a converter that does a best-effort conversion from the tagset generated by \textcite{oflazer1994}. 
It is a simple xfst script that takes \textcite{oflazer1994} as surface,
and generates TRmorph tags as the surface string.
It was used/tested in in analysis mode (converting \emph{to} TRmorph tags).
However, it will produce multiple strings in the other direction,
and the conversion \emph{from} TRmorph is not tested, and may not work as expected.
The conversion utility can be found as \lstinline{converters/o2t.xfst}.
The subdirectory contains a make file to build the binary file.
The resulting binary will be called \lstinline{o2t.fst}.

Another conversion utility that converts TRmorph output to a format similar to the output of MOR utility of CHILDES \parencite{macwhinney1985,macwhinney1990} is currently in development,
will be made part of the standard TRmorph distribution soon.

\subsection{Grapheme to phoneme conversion (g2p)}

TRmorph includes an (experimental) grapheme to phoneme converter.
The converter takes an analysis string and converts it to a phonemic representation in IPA.
Turkish grapheme-to-phoneme conversion is (almost) trivial, 
the orthographic symbols map to phonetic symbols in a one-to-one fashion with simple context effects and a few exceptions.
The conversion of orthographic symbols to the corresponding IPA symbols follows \textcite{goksel2005}.
The tricky part is determining the location of stress.

In summary, the regular stress falls on the last syllable of a root form.
With most suffixes, the stress moves to the last syllable as new suffixes are added.
For example the regular root \xmplt{oku}{read} followed by future TAM marker and first person singular agreement will result in IPA conversion \textIPA{okʰujɑdʒʰɑγˈɯm}.
Some suffixes contain non-stressable syllables.
In those cases, stress moves to the syllable preceding the non-stressable syllable.
For example, \sffx{yor} in \xmpl{okuyabiliyorum} will result in the IPA string \textIPA{okʰujɑbiłˈijorum}.
Some root forms, notably palace names, compounds and some foreign borrowings show irregular stress.
If a root is irregular, stress is on a non-final syllable, 
and stays at the same place with further suffixation with the exception of the negative suffix \sffx{mA}.
For example, for the irregular root \xmplt{nitele}{characterize/describe}, 
the suffixation without a negative suffix will leave the stress on the first syllable 
(\xmpl{niteliyorum} is pronounced \textIPA{nˈitʰełijorum}), 
but negative marker move the stress to the syllable before itself
(\xmpl{nitelemiyourm} is pronounced \textIPA{nitʰełˈemijorum}). 
Note that this will cause disambiguated surface forms to have ambiguous g2p conversions. 
For example the word \xmpl{okuma} will be converted to both 
\xmplt{\textIPA{okʰumˈɑ}}{\mroot{oku}\mtag{V}\mtag{vn:inf}\mtag{N}, meaning reading} and
\xmplt{\textIPA{okʰˈumɑ}}{\mroot{oku}\mtag{V}\mtag{neg}\mtag{imp}\mtag{2s}, don't read}.

TRmorph g2p component takes an analysis string and produces an IPA string in the generation mode.
If the word does not have an exceptional stress marker in the lexicon,
stress symbol is before the last vowel or the vowel that precedes a non-stressable syllable.
The regular roots should not have any stress marking in the lexicon.
If the exceptional stress is indicated in the lexicon,
the affixes other than the negative marker do not change its location.
Currently, the stress marker is placed before the vowel.
The code for inserting syllable boundaries and the shifting the stress marker before the syllable is present in the file \lstinline{g2p.xfst},
but it is not used by default.

As of this writing, g2p is is still experimental, and not tested throughly.
Here are a list of things you should keep in mind while using this utility.

\begin{itemize}
    \item The exceptional stress marking in the lexicon is far from complete.
        Especially, not all place names and compound forms are adequately marked.
    \item The foreign words, mainly proper names,  
        that are written as in their origin are mispronounced
        (e.g., `Coca Cola').
        Currently there is no mechanism to mark these, 
        or to specify an alternative pronunciation. 
    \item Similar to the negative marker, 
        \textcite[p.30]{goksel2005} list a number of other (polysyllabic) suffixes that cause some speakers to shift the stress to the preceding syllable regardless of the root form.
        Trmorph g2p does not produce multiple pronunciations for these suffixes.
    \item Since TRmorph only deals with the `written words', 
        the stress computation for compound words written separately,
        and clitics altering stress in the preceding word are not dealt with.
    \item Although TRmorph lexicon includes some exceptional stress marking,
        these are not checked well.
        The current markings are mainly based on \href{http://en.wiktionary.org/wiki/Wiktionary:Main_Page}{Wiktionary} definitions.
        Most of them are also checked automatically on  online dictionary of \href{http://en.wiktionary.org/wiki/Wiktionary:Main_Page}{Dil Derneği}.

        It also seems some of these are difficult determine.
        For example the word \xmplt{zatüre}{pneumonia} is marked as stressed on the first syllable in the dictionary of \href{http://www.dildernegi.org.tr/}{Dil Derneği}, 
        but marked as finally stressed by \textcite{ergenc2002}.
        To add to the mix, my first intuition would be for medial stress.
\end{itemize}



\section{\label{sec:disambiguation}Morphological disambiguator}

TRmorph distribution currently includes a simple `zero-context' disambiguator written in python.
Work on disambiguation is still under way. 
The related files and this  documentation will be updated with the developments on the disambiguator.
The script for disambiguation is \lstinline{scripts/disambiguate.py}.
The script takes one token per line from its standard input,
analyzes them using TRmorph,
and prints a ranked list, by default with their scores (log probabilities).
For details see the explanation on top of the script or
the help text produced when run with the command line argument \lstinline{--help}.
The disambiguation script uses an external `model file'
An example model trained on the data set used by \textcite{yuret2006} (originated from \textcite{hakkani-tur2002}) can be found at
\url{http://coltekin.net/cagri/trmorph/1M.m2}.
With this setting, the expected accuracy of the disambiguator is about 85\%.
In other words, expect an error in every 7 tokens or so.
The details on the method used for disambiguation and tools for training custom models will follow.


\section*{Acknowledgements}

The following is an incomplete list of people (ordered with \lstinline{sort -R}) 
that I received valuable ideas, comments, corrections, patches or encouragement:%
\footnote{I started making this list 8 years after the first attempts at building TRmorph, 
so it is necessarily incomplete. 
I appreciate any reminders or corrections.} 
Can Bruce, 
Güliz Güneş, 
Taner Sezer, 
Cem Bozşahin, 
Şükriye Ruhi, 
John Nerbonne, 
folks working on Apertium-Turkic,
and definitely more.

\printbibliography

\printindex

\end{document}
